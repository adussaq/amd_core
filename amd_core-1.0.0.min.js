/*!
 * @overview amd_core.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
 * @version   1.0.0
 */

var amd_core = function(){
var restURL,jQueryURL,polyfillPromiseURL,getRest,getJquery,getPolyfill,polyfillPromises,ajaxPromise,requireBuffer,checklist,checkcallback,coreObj,redefineCoreFunctions,require,loaded;return requireBuffer=[],loaded={},coreObj={require:function(r){requireBuffer.push(r)}},


// Below are the variables you set for what to require before any other loading takes place
// jQuery and polyfill promises are required.
jQueryURL="https://alexdussaq.info/amd_core/jquery.min.js",
polyfillPromiseURL="https://raw.githubusercontent.com/jakearchibald/es6-promise/master/dist/es6-promise.min.js",
restURL=[],

coreObj.isArray=function(){if(Array.isArray)return Array.isArray;var r=Object.prototype.toString,e=r.call([]);return function(o){return r.call(o)===e}}(),ajaxPromise=function(r){var e,o,t,n;return e=function(e){return function(){e(r)}},o=function(e){return function(o){loaded[r]=!1,e(new Error("failed to get: "+r+" statusText: "+o.statusText+" status: "+o.status))}},n=function(){return new Promise(function(t,n){$.ajax({url:r,dataType:"script",success:e(t),error:o(n)})})},loaded[r]?(t=loaded[r],t["catch"](function(){loaded[r]=!1})):t=n(),loaded[r]=t,t},checkcallback=function(r){return"function"==typeof r?!0:(console.error(new Error("Callback in coreObj.require not defined, this is a required parameter.")),!1)},checklist=function(r){var e,o=!0;if("object"!=typeof r&&(console.error(new Error("List for require must be an object.")),o=!1),r.hasOwnProperty("ordered"))if(coreObj.isArray(r.ordered))for(e=0;e<r.ordered.length;e+=1)coreObj.isArray(r.ordered[e])||(console.error(new Error("Each element in the array for Ordered List for require must also be an array.")),o=!1);else console.error(new Error("Ordered list for require must be an array.")),o=!1;else r.ordered=[[]];return r.hasOwnProperty("async")?coreObj.isArray(r.async)||(console.error(new Error("Async List for require must be an array.")),o=!1):r.async=[],o},redefineCoreFunctions=function(){var r;for(coreObj.require=require,r=0;r<requireBuffer.length;r+=1)require(requireBuffer[r])},require=function(r){var e,o,t,n,s,i,a,l,c,u,f,d;if(o=[],f=[],d={},c=r,u=r.callback,l=function(r){console.error("Was unable to load module: ",r)},s=function(r){return function(){var e=ajaxPromise(r);return e}},checklist(c)&&checkcallback(u)){for(f=f.concat(c.async),f=f.concat.apply(f,c.ordered),t=0;t<c.async.length;t+=1)i=c.async[t],e=ajaxPromise(i),o.push(e["catch"](l));for(t=0;t<c.ordered.length;t+=1){for(a=Promise.resolve(),n=0;n<c.ordered[t].length;n+=1)i=c.ordered[t][n],a=a.then(s(i));a=a["catch"](l),o.push(a)}}Promise.all(o).then(function(){var r,e,o,t,n;for(o=[],t=function(r){return function(){d[r].loaded=!0}},n=function(r){return function(){d[r].loaded=!1}},r=0;r<f.length;r+=1)e=f[r],d[e]=loaded[e]?{url:e,promise:loaded[e]}:{url:e,promise:Promise.reject("Script never reached, at least one of the prerequisites failed to load.")},o.push(d[e].promise.then(t(e),n(e)));Promise.all(o).then(function(){u(d)})})},getJquery=function(callback,error){var req,onloadF,onerrorF;onloadF=function(){200===req.status?(eval(req.response),console.log("Got jQuery, other loading will now begin."),callback(req.response)):error(new Error("Could not load jQuery: "+req.statusText))},onerrorF=function(){error(new Error("Could not load jQuery: Network Error"))},req=new XMLHttpRequest,req.open("GET",jQueryURL),req.onload=onloadF,req.onerror=onerrorF,req.send()},getPolyfill=function(r,e){console.warn("This browser does not support promises, getting polyfill for promises, but this only offerspartial support, see: https://github.com/jakearchibald/es6-promise#readme"),$.ajax({url:polyfillPromiseURL,dataType:"script",success:r,error:e})},getRest=function(){var r,e,o=[];for(e=function(r){console.error("Failed to get core module: "+r)},r=0;r<restURL.length;r+=1)o.push(ajaxPromise(restURL[r])["catch"](e));Promise.all(o).then(redefineCoreFunctions)},polyfillPromises=function(){window.Promise?getRest():getPolyfill(getRest,function(r){getPolyfill(getRest,function(e){console.error("After two attempts, could not load Promises.",r,e)})})},window.jQuery||getJquery(polyfillPromises,function(r){getJquery(polyfillPromises,function(e){console.error("After two attempts, could not load jQuery.",r,e)})}),coreObj}();